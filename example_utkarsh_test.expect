#!/usr/bin/expect
set timeout 10
set hostname [lindex $argv 0]
log_user 1

if {[llength $argv] == 0} {
  send_user "Usage: scriptname hostname\n"
  exit 1
}

# send_user "\n#####\n# $hostname\n#####\n"

spawn ssh -q dev@$hostname

expect "dev@"







send "cd \$HOME/UTKARSH/01062020\n"
expect "dev@"
send "git clone https://github.com/SQ-ONE/ifrm-api.git\n"
expect "cloning"
expect "username"
send "rahul5196\n"
expect "password"
send "square123**\n"
expect "remote"
expect "dev@"
send "cd ifrm-api\n"
expect "dev@"
send "git checkout v0.17-beta\n"
expect "Note:"
expect "dev@"
send "mv ifrm.prod.conf.example ifrm.prod.conf\n"
expect "dev@"
send "echo \"pidfile.path=/dev/null\" \>> ifrm.prod.conf\n"
expect "dev"
send "sed \-i \'s\+cassandra.url \= \"http\:\/\/localhost\:9042\"\+cassandra.url \= \"http\:\/\/10.182.14.33\:9042\"\+g\' ifrm.prod.conf\n"
expect "dev@"
send "cp \$HOME/files/configuration_files/add.txt \$HOME/UTKARSH/01062020/ifrm-api/\n"
expect "dev@"
send "sed \-i.bak \'\/lazy val \`ifrm-common\` \= \(project in file\(\"ifrm-common\"\)\)\/r add.txt\' build.sbt\n"
expect "import"
expect "dev"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-user-access-management-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "sed -i 's+brokers = "127.0.0.1:9092"+brokers = "10.182.14.13:9092"' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-case-review-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-customer-service-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-investigation-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-transaction-monitoring-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-screener-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-atm-rule-engine-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-atm-cognitive-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-pos-rule-engine-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-pos-cognitive-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-ecom-rule-engine-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-ecom-cognitive-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-ibmb-rule-engine-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"
send "cd \$HOME/UTKARSH/01062020/ifrm-api/ifrm-ibmb-cognitive-impl/src/main/resources\n"
expect "dev@"
send "sed \-i \'s\+localhost\+10.182.14.33\+g\' production.conf\n"
expect "dev@"



















send "cd \$HOME/UTKARSH/01062020/ifrm-api\n"
send "sbt clean compile\n"
expect "\["
expect "dev@"
send "sbt docker:publishLocal\n"
expect "\["
expect "dev@"

interact





